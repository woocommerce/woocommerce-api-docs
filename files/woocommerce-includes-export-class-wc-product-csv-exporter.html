<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>WooCommerce Code Reference</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="shortcut icon" href="../images/favicon.png" />
    <link rel="apple-touch-icon" href="../images/apple-touch-icon.png"/>
    <link rel="apple-touch-icon" sizes="72x72" href="../images/apple-touch-icon-72x72.png"/>
    <link rel="apple-touch-icon" sizes="114x114" href="../images/apple-touch-icon-114x114.png"/>
    <link rel="stylesheet" href="../css/normalize.css">
    <link rel="stylesheet" href="../css/base.css?updated=1626085995">
    <link href="https://fonts.googleapis.com/css2?family=Source+Sans+Pro:wght@400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="../css/template.css?updated=1626085995">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.0/css/all.min.css" integrity="sha256-ybRkN9dBjhcS2qrW1z+hfCxq+1aBdwyQM5wlQoQVt/0=" crossorigin="anonymous" />
            <script src="https://cdn.jsdelivr.net/npm/css-vars-ponyfill@2"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.0/js/all.min.js" integrity="sha256-0vuk8LXoyrmCjp1f0O300qo1M75ZQyhH9X3J6d+scmk=" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/@tarekraafat/autocomplete.js@7.2.0/dist/js/autoComplete.min.js"></script>
    <!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-8KCYZ2CYMS"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-8KCYZ2CYMS', {
		'content_group' : 'WooCommerce Core Code Reference',
	});
</script>
        <script src="../js/prism.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            window.dispatchEvent(new HashChangeEvent('hashchange'));
        });
    </script>
</head>
<body id="top">
    <header class="phpdocumentor-top-header">
    <section class="phpdocumentor-section">
        <div class="site-branding">
            <a class="site-logo" href="../index.html"><img width="180" src="../images/logo.svg" alt="WooCommerce" /></a>
        </div>
        <nav class="main-navigation">
            <ul>
                <li><a href="../hooks/hooks.html">Hooks Reference</a></li>
                <li><a href="https://docs.woocommerce.com/">Documentation</a></li>
                <li><a href="https://woocommerce.github.io/woocommerce-rest-api-docs/">REST API Docs</a></li>
            </ul>
        </nav>
    </section>
</header>

<div class="phpdocumentor-header">
    <section class="phpdocumentor-section">
        <h1 class="phpdocumentor-title">WooCommerce Code Reference</h1>
        <section class="phpdocumentor-search">
    <label class="phpdocumentor-label">
        <span class="visually-hidden">Search (click ESC to close search results)</span>
        <input id="autoComplete" tabindex="1" type="search" class="phpdocumentor-field phpdocumentor-search__field" placeholder="Loading..." disabled />
    </label>
</section>

    </section>
</div>

    <main class="phpdocumentor">
        <div class="phpdocumentor-section">
            <aside class="phpdocumentor-column -four phpdocumentor-sidebar">
    
    <section class="phpdocumentor-sidebar__category">
        <h2 class="phpdocumentor-sidebar__category-header">Namespaces</h2>
                                <h3 class="phpdocumentor-sidebar__root-namespace"><a href="../namespaces/default.html"><abbr title="\">Global</abbr></a></h3>
                                        <h4 class="phpdocumentor-sidebar__root-namespace"><a href="../namespaces/automattic.html"><abbr title="\Automattic">Automattic</abbr></a></h4>
                <ul class="phpdocumentor-list">
                                            <li><a href="../namespaces/automattic-woocommerce.html"><abbr title="\Automattic\WooCommerce">WooCommerce</abbr></a></li>
                                    </ul>
                        </section>

        <section class="phpdocumentor-sidebar__category">
        <h2 class="phpdocumentor-sidebar__category-header">Packages</h2>
                    <h3 class="phpdocumentor-sidebar__root-package"><a href="../packages/WooCommerce.html"><abbr title="\WooCommerce">WooCommerce</abbr></a></h3>
                        <ul class="phpdocumentor-list">
                                    <li><a href="../packages/WooCommerce-Classes.html"><abbr title="\WooCommerce\Classes">Classes</abbr></a></li>
                                    <li><a href="../packages/WooCommerce-Abstracts.html"><abbr title="\WooCommerce\Abstracts">Abstracts</abbr></a></li>
                                    <li><a href="../packages/WooCommerce-Admin.html"><abbr title="\WooCommerce\Admin">Admin</abbr></a></li>
                                    <li><a href="../packages/WooCommerce-Views.html"><abbr title="\WooCommerce\Views">Views</abbr></a></li>
                                    <li><a href="../packages/WooCommerce-Helper.html"><abbr title="\WooCommerce\Helper">Helper</abbr></a></li>
                                    <li><a href="../packages/WooCommerce-Templates.html"><abbr title="\WooCommerce\Templates">Templates</abbr></a></li>
                                    <li><a href="../packages/WooCommerce-Reports.html"><abbr title="\WooCommerce\Reports">Reports</abbr></a></li>
                                    <li><a href="../packages/WooCommerce-Blocks.html"><abbr title="\WooCommerce\Blocks">Blocks</abbr></a></li>
                                    <li><a href="../packages/WooCommerce-RestApi.html"><abbr title="\WooCommerce\RestApi">RestApi</abbr></a></li>
                                    <li><a href="../packages/WooCommerce-CLI.html"><abbr title="\WooCommerce\CLI">CLI</abbr></a></li>
                                    <li><a href="../packages/WooCommerce-l10n.html"><abbr title="\WooCommerce\l10n">l10n</abbr></a></li>
                                    <li><a href="../packages/WooCommerce-Webhooks.html"><abbr title="\WooCommerce\Webhooks">Webhooks</abbr></a></li>
                                    <li><a href="../packages/WooCommerce-DataStores.html"><abbr title="\WooCommerce\DataStores">DataStores</abbr></a></li>
                                    <li><a href="../packages/WooCommerce-Emails.html"><abbr title="\WooCommerce\Emails">Emails</abbr></a></li>
                                    <li><a href="../packages/WooCommerce-Export.html"><abbr title="\WooCommerce\Export">Export</abbr></a></li>
                                    <li><a href="../packages/WooCommerce-Gateways.html"><abbr title="\WooCommerce\Gateways">Gateways</abbr></a></li>
                                    <li><a href="../packages/WooCommerce-PayPal.html"><abbr title="\WooCommerce\PayPal">PayPal</abbr></a></li>
                                    <li><a href="../packages/WooCommerce-Import.html"><abbr title="\WooCommerce\Import">Import</abbr></a></li>
                                    <li><a href="../packages/WooCommerce-Integrations.html"><abbr title="\WooCommerce\Integrations">Integrations</abbr></a></li>
                                    <li><a href="../packages/WooCommerce-Interfaces.html"><abbr title="\WooCommerce\Interfaces">Interfaces</abbr></a></li>
                                    <li><a href="../packages/WooCommerce-Interface.html"><abbr title="\WooCommerce\Interface">Interface</abbr></a></li>
                                    <li><a href="../packages/WooCommerce-LogHandlers.html"><abbr title="\WooCommerce\LogHandlers">LogHandlers</abbr></a></li>
                                    <li><a href="../packages/WooCommerce-PaymentTokens.html"><abbr title="\WooCommerce\PaymentTokens">PaymentTokens</abbr></a></li>
                                    <li><a href="../packages/WooCommerce-Utilities.html"><abbr title="\WooCommerce\Utilities">Utilities</abbr></a></li>
                                    <li><a href="../packages/WooCommerce-Shipping.html"><abbr title="\WooCommerce\Shipping">Shipping</abbr></a></li>
                                    <li><a href="../packages/WooCommerce-Shortcodes.html"><abbr title="\WooCommerce\Shortcodes">Shortcodes</abbr></a></li>
                                    <li><a href="../packages/WooCommerce-Tracks.html"><abbr title="\WooCommerce\Tracks">Tracks</abbr></a></li>
                                    <li><a href="../packages/WooCommerce-Traits.html"><abbr title="\WooCommerce\Traits">Traits</abbr></a></li>
                                    <li><a href="../packages/WooCommerce-Functions.html"><abbr title="\WooCommerce\Functions">Functions</abbr></a></li>
                                    <li><a href="../packages/WooCommerce-WCCom.html"><abbr title="\WooCommerce\WCCom">WCCom</abbr></a></li>
                                    <li><a href="../packages/WooCommerce-Widgets.html"><abbr title="\WooCommerce\Widgets">Widgets</abbr></a></li>
                                    <li><a href="../packages/WooCommerce-Uninstaller.html"><abbr title="\WooCommerce\Uninstaller">Uninstaller</abbr></a></li>
                            </ul>
                                <h3 class="phpdocumentor-sidebar__root-package"><a href="../packages/WoocommerceAdmin.html"><abbr title="\WoocommerceAdmin">WoocommerceAdmin</abbr></a></h3>
                                <h3 class="phpdocumentor-sidebar__root-package"><a href="../packages/WoocommerceNavigation.html"><abbr title="\WoocommerceNavigation">WoocommerceNavigation</abbr></a></h3>
                                <h3 class="phpdocumentor-sidebar__root-package"><a href="../packages/Automattic.html"><abbr title="\Automattic">Automattic</abbr></a></h3>
                        <ul class="phpdocumentor-list">
                                    <li><a href="../packages/Automattic-WooCommerce.html"><abbr title="\Automattic\WooCommerce">WooCommerce</abbr></a></li>
                            </ul>
                        </section>
    
    <section class="phpdocumentor-sidebar__category">
        <h2 class="phpdocumentor-sidebar__category-header">Reports</h2>
                <h3 class="phpdocumentor-sidebar__root-package"><a href="../reports/deprecated.html">Deprecated</a></h3>
        <h3 class="phpdocumentor-sidebar__root-package"><a href="../reports/errors.html">Errors</a></h3>
        <h3 class="phpdocumentor-sidebar__root-package"><a href="../reports/markers.html">Markers</a></h3>
    </section>

    <section class="phpdocumentor-sidebar__category">
        <h2 class="phpdocumentor-sidebar__category-header">Indices</h2>
        <h3 class="phpdocumentor-sidebar__root-package"><a href="../indices/files.html">Files</a></h3>
        <h3 class="phpdocumentor-sidebar__root-package"><a href="../hooks/hooks.html">Hooks Reference</a></h3>
    </section>
</aside>

            <div class="phpdocumentor-column -eight phpdocumentor-content">
                    <ul class="phpdocumentor-breadcrumbs">
    </ul>

    <article class="phpdocumentor-element -file">
        <h2 class="phpdocumentor-content__title">class-wc-product-csv-exporter.php</h2>

                

        
                    <h3 class="phpdocumentor-elements__header" id="source-code">
                Source code
                <a href="#source-code" class="headerlink"><i class="fas fa-link"></i></a>
            </h3>
            <pre id="source-view" tabindex="-1" class="language-php line-numbers linkable-line-numbers"><code>&lt;?php
/**
 * Handles product CSV export.
 *
 * @package WooCommerce\Export
 * @version 3.1.0
 */

if ( ! defined( &#039;ABSPATH&#039; ) ) {
	exit;
}

/**
 * Include dependencies.
 */
if ( ! class_exists( &#039;WC_CSV_Batch_Exporter&#039;, false ) ) {
	include_once WC_ABSPATH . &#039;includes/export/abstract-wc-csv-batch-exporter.php&#039;;
}

/**
 * WC_Product_CSV_Exporter Class.
 */
class WC_Product_CSV_Exporter extends WC_CSV_Batch_Exporter {

	/**
	 * Type of export used in filter names.
	 *
	 * @var string
	 */
	protected $export_type = &#039;product&#039;;

	/**
	 * Should meta be exported?
	 *
	 * @var boolean
	 */
	protected $enable_meta_export = false;

	/**
	 * Which product types are being exported.
	 *
	 * @var array
	 */
	protected $product_types_to_export = array();

	/**
	 * Products belonging to what category should be exported.
	 *
	 * @var string
	 */
	protected $product_category_to_export = array();

	/**
	 * Constructor.
	 */
	public function __construct() {
		parent::__construct();
		$this-&gt;set_product_types_to_export( array_keys( WC_Admin_Exporters::get_product_types() ) );
	}

	/**
	 * Should meta be exported?
	 *
	 * @param bool $enable_meta_export Should meta be exported.
	 *
	 * @since 3.1.0
	 */
	public function enable_meta_export( $enable_meta_export ) {
		$this-&gt;enable_meta_export = (bool) $enable_meta_export;
	}

	/**
	 * Product types to export.
	 *
	 * @param array $product_types_to_export List of types to export.
	 *
	 * @since 3.1.0
	 */
	public function set_product_types_to_export( $product_types_to_export ) {
		$this-&gt;product_types_to_export = array_map( &#039;wc_clean&#039;, $product_types_to_export );
	}

	/**
	 * Product category to export
	 *
	 * @param string $product_category_to_export Product category slug to export, empty string exports all.
	 *
	 * @since  3.5.0
	 * @return void
	 */
	public function set_product_category_to_export( $product_category_to_export ) {
		$this-&gt;product_category_to_export = array_map( &#039;sanitize_title_with_dashes&#039;, $product_category_to_export );
	}

	/**
	 * Return an array of columns to export.
	 *
	 * @since  3.1.0
	 * @return array
	 */
	public function get_default_column_names() {
		return apply_filters(
			&quot;woocommerce_product_export_{$this-&gt;export_type}_default_columns&quot;,
			array(
				&#039;id&#039;                 =&gt; __( &#039;ID&#039;, &#039;woocommerce&#039; ),
				&#039;type&#039;               =&gt; __( &#039;Type&#039;, &#039;woocommerce&#039; ),
				&#039;sku&#039;                =&gt; __( &#039;SKU&#039;, &#039;woocommerce&#039; ),
				&#039;name&#039;               =&gt; __( &#039;Name&#039;, &#039;woocommerce&#039; ),
				&#039;published&#039;          =&gt; __( &#039;Published&#039;, &#039;woocommerce&#039; ),
				&#039;featured&#039;           =&gt; __( &#039;Is featured?&#039;, &#039;woocommerce&#039; ),
				&#039;catalog_visibility&#039; =&gt; __( &#039;Visibility in catalog&#039;, &#039;woocommerce&#039; ),
				&#039;short_description&#039;  =&gt; __( &#039;Short description&#039;, &#039;woocommerce&#039; ),
				&#039;description&#039;        =&gt; __( &#039;Description&#039;, &#039;woocommerce&#039; ),
				&#039;date_on_sale_from&#039;  =&gt; __( &#039;Date sale price starts&#039;, &#039;woocommerce&#039; ),
				&#039;date_on_sale_to&#039;    =&gt; __( &#039;Date sale price ends&#039;, &#039;woocommerce&#039; ),
				&#039;tax_status&#039;         =&gt; __( &#039;Tax status&#039;, &#039;woocommerce&#039; ),
				&#039;tax_class&#039;          =&gt; __( &#039;Tax class&#039;, &#039;woocommerce&#039; ),
				&#039;stock_status&#039;       =&gt; __( &#039;In stock?&#039;, &#039;woocommerce&#039; ),
				&#039;stock&#039;              =&gt; __( &#039;Stock&#039;, &#039;woocommerce&#039; ),
				&#039;low_stock_amount&#039;   =&gt; __( &#039;Low stock amount&#039;, &#039;woocommerce&#039; ),
				&#039;backorders&#039;         =&gt; __( &#039;Backorders allowed?&#039;, &#039;woocommerce&#039; ),
				&#039;sold_individually&#039;  =&gt; __( &#039;Sold individually?&#039;, &#039;woocommerce&#039; ),
				/* translators: %s: weight */
				&#039;weight&#039;             =&gt; sprintf( __( &#039;Weight (%s)&#039;, &#039;woocommerce&#039; ), get_option( &#039;woocommerce_weight_unit&#039; ) ),
				/* translators: %s: length */
				&#039;length&#039;             =&gt; sprintf( __( &#039;Length (%s)&#039;, &#039;woocommerce&#039; ), get_option( &#039;woocommerce_dimension_unit&#039; ) ),
				/* translators: %s: width */
				&#039;width&#039;              =&gt; sprintf( __( &#039;Width (%s)&#039;, &#039;woocommerce&#039; ), get_option( &#039;woocommerce_dimension_unit&#039; ) ),
				/* translators: %s: Height */
				&#039;height&#039;             =&gt; sprintf( __( &#039;Height (%s)&#039;, &#039;woocommerce&#039; ), get_option( &#039;woocommerce_dimension_unit&#039; ) ),
				&#039;reviews_allowed&#039;    =&gt; __( &#039;Allow customer reviews?&#039;, &#039;woocommerce&#039; ),
				&#039;purchase_note&#039;      =&gt; __( &#039;Purchase note&#039;, &#039;woocommerce&#039; ),
				&#039;sale_price&#039;         =&gt; __( &#039;Sale price&#039;, &#039;woocommerce&#039; ),
				&#039;regular_price&#039;      =&gt; __( &#039;Regular price&#039;, &#039;woocommerce&#039; ),
				&#039;category_ids&#039;       =&gt; __( &#039;Categories&#039;, &#039;woocommerce&#039; ),
				&#039;tag_ids&#039;            =&gt; __( &#039;Tags&#039;, &#039;woocommerce&#039; ),
				&#039;shipping_class_id&#039;  =&gt; __( &#039;Shipping class&#039;, &#039;woocommerce&#039; ),
				&#039;images&#039;             =&gt; __( &#039;Images&#039;, &#039;woocommerce&#039; ),
				&#039;download_limit&#039;     =&gt; __( &#039;Download limit&#039;, &#039;woocommerce&#039; ),
				&#039;download_expiry&#039;    =&gt; __( &#039;Download expiry days&#039;, &#039;woocommerce&#039; ),
				&#039;parent_id&#039;          =&gt; __( &#039;Parent&#039;, &#039;woocommerce&#039; ),
				&#039;grouped_products&#039;   =&gt; __( &#039;Grouped products&#039;, &#039;woocommerce&#039; ),
				&#039;upsell_ids&#039;         =&gt; __( &#039;Upsells&#039;, &#039;woocommerce&#039; ),
				&#039;cross_sell_ids&#039;     =&gt; __( &#039;Cross-sells&#039;, &#039;woocommerce&#039; ),
				&#039;product_url&#039;        =&gt; __( &#039;External URL&#039;, &#039;woocommerce&#039; ),
				&#039;button_text&#039;        =&gt; __( &#039;Button text&#039;, &#039;woocommerce&#039; ),
				&#039;menu_order&#039;         =&gt; __( &#039;Position&#039;, &#039;woocommerce&#039; ),
			)
		);
	}

	/**
	 * Prepare data for export.
	 *
	 * @since 3.1.0
	 */
	public function prepare_data_to_export() {
		$args = array(
			&#039;status&#039;   =&gt; array( &#039;private&#039;, &#039;publish&#039;, &#039;draft&#039;, &#039;future&#039;, &#039;pending&#039; ),
			&#039;type&#039;     =&gt; $this-&gt;product_types_to_export,
			&#039;limit&#039;    =&gt; $this-&gt;get_limit(),
			&#039;page&#039;     =&gt; $this-&gt;get_page(),
			&#039;orderby&#039;  =&gt; array(
				&#039;ID&#039; =&gt; &#039;ASC&#039;,
			),
			&#039;return&#039;   =&gt; &#039;objects&#039;,
			&#039;paginate&#039; =&gt; true,
		);

		if ( ! empty( $this-&gt;product_category_to_export ) ) {
			$args[&#039;category&#039;] = $this-&gt;product_category_to_export;
		}
		$products = wc_get_products( apply_filters( &quot;woocommerce_product_export_{$this-&gt;export_type}_query_args&quot;, $args ) );

		$this-&gt;total_rows  = $products-&gt;total;
		$this-&gt;row_data    = array();
		$variable_products = array();

		foreach ( $products-&gt;products as $product ) {
			// Check if the category is set, this means we need to fetch variations seperately as they are not tied to a category.
			if ( ! empty( $args[&#039;category&#039;] ) &amp;&amp; $product-&gt;is_type( &#039;variable&#039; ) ) {
				$variable_products[] = $product-&gt;get_id();
			}

			$this-&gt;row_data[] = $this-&gt;generate_row_data( $product );
		}

		// If a category was selected we loop through the variations as they are not tied to a category so will be excluded by default.
		if ( ! empty( $variable_products ) ) {
			foreach ( $variable_products as $parent_id ) {
				$products = wc_get_products(
					array(
						&#039;parent&#039; =&gt; $parent_id,
						&#039;type&#039;   =&gt; array( &#039;variation&#039; ),
						&#039;return&#039; =&gt; &#039;objects&#039;,
						&#039;limit&#039;  =&gt; -1,
					)
				);

				if ( ! $products ) {
					continue;
				}

				foreach ( $products as $product ) {
					$this-&gt;row_data[] = $this-&gt;generate_row_data( $product );
				}
			}
		}
	}

	/**
	 * Take a product and generate row data from it for export.
	 *
	 * @param WC_Product $product WC_Product object.
	 *
	 * @return array
	 */
	protected function generate_row_data( $product ) {
		$columns = $this-&gt;get_column_names();
		$row     = array();
		foreach ( $columns as $column_id =&gt; $column_name ) {
			$column_id = strstr( $column_id, &#039;:&#039; ) ? current( explode( &#039;:&#039;, $column_id ) ) : $column_id;
			$value     = &#039;&#039;;

			// Skip some columns if dynamically handled later or if we&#039;re being selective.
			if ( in_array( $column_id, array( &#039;downloads&#039;, &#039;attributes&#039;, &#039;meta&#039; ), true ) || ! $this-&gt;is_column_exporting( $column_id ) ) {
				continue;
			}

			if ( has_filter( &quot;woocommerce_product_export_{$this-&gt;export_type}_column_{$column_id}&quot; ) ) {
				// Filter for 3rd parties.
				$value = apply_filters( &quot;woocommerce_product_export_{$this-&gt;export_type}_column_{$column_id}&quot;, &#039;&#039;, $product, $column_id );

			} elseif ( is_callable( array( $this, &quot;get_column_value_{$column_id}&quot; ) ) ) {
				// Handle special columns which don&#039;t map 1:1 to product data.
				$value = $this-&gt;{&quot;get_column_value_{$column_id}&quot;}( $product );

			} elseif ( is_callable( array( $product, &quot;get_{$column_id}&quot; ) ) ) {
				// Default and custom handling.
				$value = $product-&gt;{&quot;get_{$column_id}&quot;}( &#039;edit&#039; );
			}

			if ( &#039;description&#039; === $column_id || &#039;short_description&#039; === $column_id ) {
				$value = $this-&gt;filter_description_field( $value );
			}

			$row[ $column_id ] = $value;
		}

		$this-&gt;prepare_downloads_for_export( $product, $row );
		$this-&gt;prepare_attributes_for_export( $product, $row );
		$this-&gt;prepare_meta_for_export( $product, $row );
		return apply_filters( &#039;woocommerce_product_export_row_data&#039;, $row, $product );
	}

	/**
	 * Get published value.
	 *
	 * @param WC_Product $product Product being exported.
	 *
	 * @since  3.1.0
	 * @return int
	 */
	protected function get_column_value_published( $product ) {
		$statuses = array(
			&#039;draft&#039;   =&gt; -1,
			&#039;private&#039; =&gt; 0,
			&#039;publish&#039; =&gt; 1,
		);

		// Fix display for variations when parent product is a draft.
		if ( &#039;variation&#039; === $product-&gt;get_type() ) {
			$parent = $product-&gt;get_parent_data();
			$status = &#039;draft&#039; === $parent[&#039;status&#039;] ? $parent[&#039;status&#039;] : $product-&gt;get_status( &#039;edit&#039; );
		} else {
			$status = $product-&gt;get_status( &#039;edit&#039; );
		}

		return isset( $statuses[ $status ] ) ? $statuses[ $status ] : -1;
	}

	/**
	 * Get formatted sale price.
	 *
	 * @param WC_Product $product Product being exported.
	 *
	 * @return string
	 */
	protected function get_column_value_sale_price( $product ) {
		return wc_format_localized_price( $product-&gt;get_sale_price( &#039;view&#039; ) );
	}

	/**
	 * Get formatted regular price.
	 *
	 * @param WC_Product $product Product being exported.
	 *
	 * @return string
	 */
	protected function get_column_value_regular_price( $product ) {
		return wc_format_localized_price( $product-&gt;get_regular_price() );
	}

	/**
	 * Get product_cat value.
	 *
	 * @param WC_Product $product Product being exported.
	 *
	 * @since  3.1.0
	 * @return string
	 */
	protected function get_column_value_category_ids( $product ) {
		$term_ids = $product-&gt;get_category_ids( &#039;edit&#039; );
		return $this-&gt;format_term_ids( $term_ids, &#039;product_cat&#039; );
	}

	/**
	 * Get product_tag value.
	 *
	 * @param WC_Product $product Product being exported.
	 *
	 * @since  3.1.0
	 * @return string
	 */
	protected function get_column_value_tag_ids( $product ) {
		$term_ids = $product-&gt;get_tag_ids( &#039;edit&#039; );
		return $this-&gt;format_term_ids( $term_ids, &#039;product_tag&#039; );
	}

	/**
	 * Get product_shipping_class value.
	 *
	 * @param WC_Product $product Product being exported.
	 *
	 * @since  3.1.0
	 * @return string
	 */
	protected function get_column_value_shipping_class_id( $product ) {
		$term_ids = $product-&gt;get_shipping_class_id( &#039;edit&#039; );
		return $this-&gt;format_term_ids( $term_ids, &#039;product_shipping_class&#039; );
	}

	/**
	 * Get images value.
	 *
	 * @param WC_Product $product Product being exported.
	 *
	 * @since  3.1.0
	 * @return string
	 */
	protected function get_column_value_images( $product ) {
		$image_ids = array_merge( array( $product-&gt;get_image_id( &#039;edit&#039; ) ), $product-&gt;get_gallery_image_ids( &#039;edit&#039; ) );
		$images    = array();

		foreach ( $image_ids as $image_id ) {
			$image = wp_get_attachment_image_src( $image_id, &#039;full&#039; );

			if ( $image ) {
				$images[] = $image[0];
			}
		}

		return $this-&gt;implode_values( $images );
	}

	/**
	 * Prepare linked products for export.
	 *
	 * @param int[] $linked_products Array of linked product ids.
	 *
	 * @since  3.1.0
	 * @return string
	 */
	protected function prepare_linked_products_for_export( $linked_products ) {
		$product_list = array();

		foreach ( $linked_products as $linked_product ) {
			if ( $linked_product-&gt;get_sku() ) {
				$product_list[] = $linked_product-&gt;get_sku();
			} else {
				$product_list[] = &#039;id:&#039; . $linked_product-&gt;get_id();
			}
		}

		return $this-&gt;implode_values( $product_list );
	}

	/**
	 * Get cross_sell_ids value.
	 *
	 * @param WC_Product $product Product being exported.
	 *
	 * @since  3.1.0
	 * @return string
	 */
	protected function get_column_value_cross_sell_ids( $product ) {
		return $this-&gt;prepare_linked_products_for_export( array_filter( array_map( &#039;wc_get_product&#039;, (array) $product-&gt;get_cross_sell_ids( &#039;edit&#039; ) ) ) );
	}

	/**
	 * Get upsell_ids value.
	 *
	 * @param WC_Product $product Product being exported.
	 *
	 * @since  3.1.0
	 * @return string
	 */
	protected function get_column_value_upsell_ids( $product ) {
		return $this-&gt;prepare_linked_products_for_export( array_filter( array_map( &#039;wc_get_product&#039;, (array) $product-&gt;get_upsell_ids( &#039;edit&#039; ) ) ) );
	}

	/**
	 * Get parent_id value.
	 *
	 * @param WC_Product $product Product being exported.
	 *
	 * @since  3.1.0
	 * @return string
	 */
	protected function get_column_value_parent_id( $product ) {
		if ( $product-&gt;get_parent_id( &#039;edit&#039; ) ) {
			$parent = wc_get_product( $product-&gt;get_parent_id( &#039;edit&#039; ) );
			if ( ! $parent ) {
				return &#039;&#039;;
			}

			return $parent-&gt;get_sku( &#039;edit&#039; ) ? $parent-&gt;get_sku( &#039;edit&#039; ) : &#039;id:&#039; . $parent-&gt;get_id();
		}
		return &#039;&#039;;
	}

	/**
	 * Get grouped_products value.
	 *
	 * @param WC_Product $product Product being exported.
	 *
	 * @since  3.1.0
	 * @return string
	 */
	protected function get_column_value_grouped_products( $product ) {
		if ( &#039;grouped&#039; !== $product-&gt;get_type() ) {
			return &#039;&#039;;
		}

		$grouped_products = array();
		$child_ids        = $product-&gt;get_children( &#039;edit&#039; );
		foreach ( $child_ids as $child_id ) {
			$child = wc_get_product( $child_id );
			if ( ! $child ) {
				continue;
			}

			$grouped_products[] = $child-&gt;get_sku( &#039;edit&#039; ) ? $child-&gt;get_sku( &#039;edit&#039; ) : &#039;id:&#039; . $child_id;
		}
		return $this-&gt;implode_values( $grouped_products );
	}

	/**
	 * Get download_limit value.
	 *
	 * @param WC_Product $product Product being exported.
	 *
	 * @since  3.1.0
	 * @return string
	 */
	protected function get_column_value_download_limit( $product ) {
		return $product-&gt;is_downloadable() &amp;&amp; $product-&gt;get_download_limit( &#039;edit&#039; ) ? $product-&gt;get_download_limit( &#039;edit&#039; ) : &#039;&#039;;
	}

	/**
	 * Get download_expiry value.
	 *
	 * @param WC_Product $product Product being exported.
	 *
	 * @since  3.1.0
	 * @return string
	 */
	protected function get_column_value_download_expiry( $product ) {
		return $product-&gt;is_downloadable() &amp;&amp; $product-&gt;get_download_expiry( &#039;edit&#039; ) ? $product-&gt;get_download_expiry( &#039;edit&#039; ) : &#039;&#039;;
	}

	/**
	 * Get stock value.
	 *
	 * @param WC_Product $product Product being exported.
	 *
	 * @since  3.1.0
	 * @return string
	 */
	protected function get_column_value_stock( $product ) {
		$manage_stock   = $product-&gt;get_manage_stock( &#039;edit&#039; );
		$stock_quantity = $product-&gt;get_stock_quantity( &#039;edit&#039; );

		if ( $product-&gt;is_type( &#039;variation&#039; ) &amp;&amp; &#039;parent&#039; === $manage_stock ) {
			return &#039;parent&#039;;
		} elseif ( $manage_stock ) {
			return $stock_quantity;
		} else {
			return &#039;&#039;;
		}
	}

	/**
	 * Get stock status value.
	 *
	 * @param WC_Product $product Product being exported.
	 *
	 * @since  3.1.0
	 * @return string
	 */
	protected function get_column_value_stock_status( $product ) {
		$status = $product-&gt;get_stock_status( &#039;edit&#039; );

		if ( &#039;onbackorder&#039; === $status ) {
			return &#039;backorder&#039;;
		}

		return &#039;instock&#039; === $status ? 1 : 0;
	}

	/**
	 * Get backorders.
	 *
	 * @param WC_Product $product Product being exported.
	 *
	 * @since  3.1.0
	 * @return string
	 */
	protected function get_column_value_backorders( $product ) {
		$backorders = $product-&gt;get_backorders( &#039;edit&#039; );

		switch ( $backorders ) {
			case &#039;notify&#039;:
				return &#039;notify&#039;;
			default:
				return wc_string_to_bool( $backorders ) ? 1 : 0;
		}
	}

	/**
	 * Get low stock amount value.
	 *
	 * @param WC_Product $product Product being exported.
	 *
	 * @since  3.5.0
	 * @return int|string Empty string if value not set
	 */
	protected function get_column_value_low_stock_amount( $product ) {
		return $product-&gt;managing_stock() &amp;&amp; $product-&gt;get_low_stock_amount( &#039;edit&#039; ) ? $product-&gt;get_low_stock_amount( &#039;edit&#039; ) : &#039;&#039;;
	}

	/**
	 * Get type value.
	 *
	 * @param WC_Product $product Product being exported.
	 *
	 * @since  3.1.0
	 * @return string
	 */
	protected function get_column_value_type( $product ) {
		$types   = array();
		$types[] = $product-&gt;get_type();

		if ( $product-&gt;is_downloadable() ) {
			$types[] = &#039;downloadable&#039;;
		}

		if ( $product-&gt;is_virtual() ) {
			$types[] = &#039;virtual&#039;;
		}

		return $this-&gt;implode_values( $types );
	}

	/**
	 * Filter description field for export.
	 * Convert newlines to &#039;\n&#039;.
	 *
	 * @param string $description Product description text to filter.
	 *
	 * @since  3.5.4
	 * @return string
	 */
	protected function filter_description_field( $description ) {
		$description = str_replace( &#039;\n&#039;, &quot;\\\\n&quot;, $description );
		$description = str_replace( &quot;\n&quot;, &#039;\n&#039;, $description );
		return $description;
	}
	/**
	 * Export downloads.
	 *
	 * @param WC_Product $product Product being exported.
	 * @param array      $row     Row being exported.
	 *
	 * @since 3.1.0
	 */
	protected function prepare_downloads_for_export( $product, &amp;$row ) {
		if ( $product-&gt;is_downloadable() &amp;&amp; $this-&gt;is_column_exporting( &#039;downloads&#039; ) ) {
			$downloads = $product-&gt;get_downloads( &#039;edit&#039; );

			if ( $downloads ) {
				$i = 1;
				foreach ( $downloads as $download ) {
					/* translators: %s: download number */
					$this-&gt;column_names[ &#039;downloads:id&#039; . $i ] = sprintf( __( &#039;Download %d ID&#039;, &#039;woocommerce&#039; ), $i );
					/* translators: %s: download number */
					$this-&gt;column_names[ &#039;downloads:name&#039; . $i ] = sprintf( __( &#039;Download %d name&#039;, &#039;woocommerce&#039; ), $i );
					/* translators: %s: download number */
					$this-&gt;column_names[ &#039;downloads:url&#039; . $i ] = sprintf( __( &#039;Download %d URL&#039;, &#039;woocommerce&#039; ), $i );
					$row[ &#039;downloads:id&#039; . $i ]                 = $download-&gt;get_id();
					$row[ &#039;downloads:name&#039; . $i ]               = $download-&gt;get_name();
					$row[ &#039;downloads:url&#039; . $i ]                = $download-&gt;get_file();
					$i++;
				}
			}
		}
	}

	/**
	 * Export attributes data.
	 *
	 * @param WC_Product $product Product being exported.
	 * @param array      $row     Row being exported.
	 *
	 * @since 3.1.0
	 */
	protected function prepare_attributes_for_export( $product, &amp;$row ) {
		if ( $this-&gt;is_column_exporting( &#039;attributes&#039; ) ) {
			$attributes         = $product-&gt;get_attributes();
			$default_attributes = $product-&gt;get_default_attributes();

			if ( count( $attributes ) ) {
				$i = 1;
				foreach ( $attributes as $attribute_name =&gt; $attribute ) {
					/* translators: %s: attribute number */
					$this-&gt;column_names[ &#039;attributes:name&#039; . $i ] = sprintf( __( &#039;Attribute %d name&#039;, &#039;woocommerce&#039; ), $i );
					/* translators: %s: attribute number */
					$this-&gt;column_names[ &#039;attributes:value&#039; . $i ] = sprintf( __( &#039;Attribute %d value(s)&#039;, &#039;woocommerce&#039; ), $i );
					/* translators: %s: attribute number */
					$this-&gt;column_names[ &#039;attributes:visible&#039; . $i ] = sprintf( __( &#039;Attribute %d visible&#039;, &#039;woocommerce&#039; ), $i );
					/* translators: %s: attribute number */
					$this-&gt;column_names[ &#039;attributes:taxonomy&#039; . $i ] = sprintf( __( &#039;Attribute %d global&#039;, &#039;woocommerce&#039; ), $i );

					if ( is_a( $attribute, &#039;WC_Product_Attribute&#039; ) ) {
						$row[ &#039;attributes:name&#039; . $i ] = wc_attribute_label( $attribute-&gt;get_name(), $product );

						if ( $attribute-&gt;is_taxonomy() ) {
							$terms  = $attribute-&gt;get_terms();
							$values = array();

							foreach ( $terms as $term ) {
								$values[] = $term-&gt;name;
							}

							$row[ &#039;attributes:value&#039; . $i ]    = $this-&gt;implode_values( $values );
							$row[ &#039;attributes:taxonomy&#039; . $i ] = 1;
						} else {
							$row[ &#039;attributes:value&#039; . $i ]    = $this-&gt;implode_values( $attribute-&gt;get_options() );
							$row[ &#039;attributes:taxonomy&#039; . $i ] = 0;
						}

						$row[ &#039;attributes:visible&#039; . $i ] = $attribute-&gt;get_visible();
					} else {
						$row[ &#039;attributes:name&#039; . $i ] = wc_attribute_label( $attribute_name, $product );

						if ( 0 === strpos( $attribute_name, &#039;pa_&#039; ) ) {
							$option_term = get_term_by( &#039;slug&#039;, $attribute, $attribute_name ); // @codingStandardsIgnoreLine.
							$row[ &#039;attributes:value&#039; . $i ]    = $option_term &amp;&amp; ! is_wp_error( $option_term ) ? str_replace( &#039;,&#039;, &#039;\\,&#039;, $option_term-&gt;name ) : str_replace( &#039;,&#039;, &#039;\\,&#039;, $attribute );
							$row[ &#039;attributes:taxonomy&#039; . $i ] = 1;
						} else {
							$row[ &#039;attributes:value&#039; . $i ]    = str_replace( &#039;,&#039;, &#039;\\,&#039;, $attribute );
							$row[ &#039;attributes:taxonomy&#039; . $i ] = 0;
						}

						$row[ &#039;attributes:visible&#039; . $i ] = &#039;&#039;;
					}

					if ( $product-&gt;is_type( &#039;variable&#039; ) &amp;&amp; isset( $default_attributes[ sanitize_title( $attribute_name ) ] ) ) {
						/* translators: %s: attribute number */
						$this-&gt;column_names[ &#039;attributes:default&#039; . $i ] = sprintf( __( &#039;Attribute %d default&#039;, &#039;woocommerce&#039; ), $i );
						$default_value                                   = $default_attributes[ sanitize_title( $attribute_name ) ];

						if ( 0 === strpos( $attribute_name, &#039;pa_&#039; ) ) {
							$option_term = get_term_by( &#039;slug&#039;, $default_value, $attribute_name ); // @codingStandardsIgnoreLine.
							$row[ &#039;attributes:default&#039; . $i ] = $option_term &amp;&amp; ! is_wp_error( $option_term ) ? $option_term-&gt;name : $default_value;
						} else {
							$row[ &#039;attributes:default&#039; . $i ] = $default_value;
						}
					}
					$i++;
				}
			}
		}
	}

	/**
	 * Export meta data.
	 *
	 * @param WC_Product $product Product being exported.
	 * @param array      $row Row data.
	 *
	 * @since 3.1.0
	 */
	protected function prepare_meta_for_export( $product, &amp;$row ) {
		if ( $this-&gt;enable_meta_export ) {
			$meta_data = $product-&gt;get_meta_data();

			if ( count( $meta_data ) ) {
				$meta_keys_to_skip = apply_filters( &#039;woocommerce_product_export_skip_meta_keys&#039;, array(), $product );

				$i = 1;
				foreach ( $meta_data as $meta ) {
					if ( in_array( $meta-&gt;key, $meta_keys_to_skip, true ) ) {
						continue;
					}

					// Allow 3rd parties to process the meta, e.g. to transform non-scalar values to scalar.
					$meta_value = apply_filters( &#039;woocommerce_product_export_meta_value&#039;, $meta-&gt;value, $meta, $product, $row );

					if ( ! is_scalar( $meta_value ) ) {
						continue;
					}

					$column_key = &#039;meta:&#039; . esc_attr( $meta-&gt;key );
					/* translators: %s: meta data name */
					$this-&gt;column_names[ $column_key ] = sprintf( __( &#039;Meta: %s&#039;, &#039;woocommerce&#039; ), $meta-&gt;key );
					$row[ $column_key ]                = $meta_value;
					$i ++;
				}
			}
		}
	}
}
</code></pre>
            </article>
            </div>
        </div>
        <a href="#top" class="phpdocumentor-back-to-top"><i class="fas fa-chevron-circle-up"></i></a>

    </main>

    <footer class="phpdocumentor phpdocumentor-footer">
    <div class="phpdocumentor-section">
        <span>WooCommerce Code Reference API documentation generated by <a href="http://www.phpdoc.org/">phpDocumentor</a> on July 12th, 2021 at 10:33 am.</span>
    </div>
</footer>

    <script>
        cssVars({});
    </script>
    <script>
        var searchParams = {
            'searchIndex': '..\/js\/searchIndex.json'
        };
    </script>
    <script src="../js/searchIndex.js?updated=1626085995"></script>
    <script src="../js/search.js?updated=1626085995"></script>
</body>
</html>
