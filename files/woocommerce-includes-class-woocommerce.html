<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>WooCommerce Code Reference</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="shortcut icon" href="../images/favicon.png" />
    <link rel="apple-touch-icon" href="../images/apple-touch-icon.png"/>
    <link rel="apple-touch-icon" sizes="72x72" href="../images/apple-touch-icon-72x72.png"/>
    <link rel="apple-touch-icon" sizes="114x114" href="../images/apple-touch-icon-114x114.png"/>
    <link rel="stylesheet" href="../css/normalize.css">
    <link rel="stylesheet" href="../css/base.css?updated=1626085995">
    <link href="https://fonts.googleapis.com/css2?family=Source+Sans+Pro:wght@400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="../css/template.css?updated=1626085995">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.0/css/all.min.css" integrity="sha256-ybRkN9dBjhcS2qrW1z+hfCxq+1aBdwyQM5wlQoQVt/0=" crossorigin="anonymous" />
            <script src="https://cdn.jsdelivr.net/npm/css-vars-ponyfill@2"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.0/js/all.min.js" integrity="sha256-0vuk8LXoyrmCjp1f0O300qo1M75ZQyhH9X3J6d+scmk=" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/@tarekraafat/autocomplete.js@7.2.0/dist/js/autoComplete.min.js"></script>
    <!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-8KCYZ2CYMS"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-8KCYZ2CYMS', {
		'content_group' : 'WooCommerce Core Code Reference',
	});
</script>
        <script src="../js/prism.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            window.dispatchEvent(new HashChangeEvent('hashchange'));
        });
    </script>
</head>
<body id="top">
    <header class="phpdocumentor-top-header">
    <section class="phpdocumentor-section">
        <div class="site-branding">
            <a class="site-logo" href="../index.html"><img width="180" src="../images/logo.svg" alt="WooCommerce" /></a>
        </div>
        <nav class="main-navigation">
            <ul>
                <li><a href="../hooks/hooks.html">Hooks Reference</a></li>
                <li><a href="https://docs.woocommerce.com/">Documentation</a></li>
                <li><a href="https://woocommerce.github.io/woocommerce-rest-api-docs/">REST API Docs</a></li>
            </ul>
        </nav>
    </section>
</header>

<div class="phpdocumentor-header">
    <section class="phpdocumentor-section">
        <h1 class="phpdocumentor-title">WooCommerce Code Reference</h1>
        <section class="phpdocumentor-search">
    <label class="phpdocumentor-label">
        <span class="visually-hidden">Search (click ESC to close search results)</span>
        <input id="autoComplete" tabindex="1" type="search" class="phpdocumentor-field phpdocumentor-search__field" placeholder="Loading..." disabled />
    </label>
</section>

    </section>
</div>

    <main class="phpdocumentor">
        <div class="phpdocumentor-section">
            <aside class="phpdocumentor-column -four phpdocumentor-sidebar">
    
    <section class="phpdocumentor-sidebar__category">
        <h2 class="phpdocumentor-sidebar__category-header">Namespaces</h2>
                                <h3 class="phpdocumentor-sidebar__root-namespace"><a href="../namespaces/default.html"><abbr title="\">Global</abbr></a></h3>
                                        <h4 class="phpdocumentor-sidebar__root-namespace"><a href="../namespaces/automattic.html"><abbr title="\Automattic">Automattic</abbr></a></h4>
                <ul class="phpdocumentor-list">
                                            <li><a href="../namespaces/automattic-woocommerce.html"><abbr title="\Automattic\WooCommerce">WooCommerce</abbr></a></li>
                                    </ul>
                        </section>

        <section class="phpdocumentor-sidebar__category">
        <h2 class="phpdocumentor-sidebar__category-header">Packages</h2>
                    <h3 class="phpdocumentor-sidebar__root-package"><a href="../packages/WooCommerce.html"><abbr title="\WooCommerce">WooCommerce</abbr></a></h3>
                        <ul class="phpdocumentor-list">
                                    <li><a href="../packages/WooCommerce-Classes.html"><abbr title="\WooCommerce\Classes">Classes</abbr></a></li>
                                    <li><a href="../packages/WooCommerce-Abstracts.html"><abbr title="\WooCommerce\Abstracts">Abstracts</abbr></a></li>
                                    <li><a href="../packages/WooCommerce-Admin.html"><abbr title="\WooCommerce\Admin">Admin</abbr></a></li>
                                    <li><a href="../packages/WooCommerce-Views.html"><abbr title="\WooCommerce\Views">Views</abbr></a></li>
                                    <li><a href="../packages/WooCommerce-Helper.html"><abbr title="\WooCommerce\Helper">Helper</abbr></a></li>
                                    <li><a href="../packages/WooCommerce-Templates.html"><abbr title="\WooCommerce\Templates">Templates</abbr></a></li>
                                    <li><a href="../packages/WooCommerce-Reports.html"><abbr title="\WooCommerce\Reports">Reports</abbr></a></li>
                                    <li><a href="../packages/WooCommerce-Blocks.html"><abbr title="\WooCommerce\Blocks">Blocks</abbr></a></li>
                                    <li><a href="../packages/WooCommerce-RestApi.html"><abbr title="\WooCommerce\RestApi">RestApi</abbr></a></li>
                                    <li><a href="../packages/WooCommerce-CLI.html"><abbr title="\WooCommerce\CLI">CLI</abbr></a></li>
                                    <li><a href="../packages/WooCommerce-l10n.html"><abbr title="\WooCommerce\l10n">l10n</abbr></a></li>
                                    <li><a href="../packages/WooCommerce-Webhooks.html"><abbr title="\WooCommerce\Webhooks">Webhooks</abbr></a></li>
                                    <li><a href="../packages/WooCommerce-DataStores.html"><abbr title="\WooCommerce\DataStores">DataStores</abbr></a></li>
                                    <li><a href="../packages/WooCommerce-Emails.html"><abbr title="\WooCommerce\Emails">Emails</abbr></a></li>
                                    <li><a href="../packages/WooCommerce-Export.html"><abbr title="\WooCommerce\Export">Export</abbr></a></li>
                                    <li><a href="../packages/WooCommerce-Gateways.html"><abbr title="\WooCommerce\Gateways">Gateways</abbr></a></li>
                                    <li><a href="../packages/WooCommerce-PayPal.html"><abbr title="\WooCommerce\PayPal">PayPal</abbr></a></li>
                                    <li><a href="../packages/WooCommerce-Import.html"><abbr title="\WooCommerce\Import">Import</abbr></a></li>
                                    <li><a href="../packages/WooCommerce-Integrations.html"><abbr title="\WooCommerce\Integrations">Integrations</abbr></a></li>
                                    <li><a href="../packages/WooCommerce-Interfaces.html"><abbr title="\WooCommerce\Interfaces">Interfaces</abbr></a></li>
                                    <li><a href="../packages/WooCommerce-Interface.html"><abbr title="\WooCommerce\Interface">Interface</abbr></a></li>
                                    <li><a href="../packages/WooCommerce-LogHandlers.html"><abbr title="\WooCommerce\LogHandlers">LogHandlers</abbr></a></li>
                                    <li><a href="../packages/WooCommerce-PaymentTokens.html"><abbr title="\WooCommerce\PaymentTokens">PaymentTokens</abbr></a></li>
                                    <li><a href="../packages/WooCommerce-Utilities.html"><abbr title="\WooCommerce\Utilities">Utilities</abbr></a></li>
                                    <li><a href="../packages/WooCommerce-Shipping.html"><abbr title="\WooCommerce\Shipping">Shipping</abbr></a></li>
                                    <li><a href="../packages/WooCommerce-Shortcodes.html"><abbr title="\WooCommerce\Shortcodes">Shortcodes</abbr></a></li>
                                    <li><a href="../packages/WooCommerce-Tracks.html"><abbr title="\WooCommerce\Tracks">Tracks</abbr></a></li>
                                    <li><a href="../packages/WooCommerce-Traits.html"><abbr title="\WooCommerce\Traits">Traits</abbr></a></li>
                                    <li><a href="../packages/WooCommerce-Functions.html"><abbr title="\WooCommerce\Functions">Functions</abbr></a></li>
                                    <li><a href="../packages/WooCommerce-WCCom.html"><abbr title="\WooCommerce\WCCom">WCCom</abbr></a></li>
                                    <li><a href="../packages/WooCommerce-Widgets.html"><abbr title="\WooCommerce\Widgets">Widgets</abbr></a></li>
                                    <li><a href="../packages/WooCommerce-Uninstaller.html"><abbr title="\WooCommerce\Uninstaller">Uninstaller</abbr></a></li>
                            </ul>
                                <h3 class="phpdocumentor-sidebar__root-package"><a href="../packages/WoocommerceAdmin.html"><abbr title="\WoocommerceAdmin">WoocommerceAdmin</abbr></a></h3>
                                <h3 class="phpdocumentor-sidebar__root-package"><a href="../packages/WoocommerceNavigation.html"><abbr title="\WoocommerceNavigation">WoocommerceNavigation</abbr></a></h3>
                                <h3 class="phpdocumentor-sidebar__root-package"><a href="../packages/Automattic.html"><abbr title="\Automattic">Automattic</abbr></a></h3>
                        <ul class="phpdocumentor-list">
                                    <li><a href="../packages/Automattic-WooCommerce.html"><abbr title="\Automattic\WooCommerce">WooCommerce</abbr></a></li>
                            </ul>
                        </section>
    
    <section class="phpdocumentor-sidebar__category">
        <h2 class="phpdocumentor-sidebar__category-header">Reports</h2>
                <h3 class="phpdocumentor-sidebar__root-package"><a href="../reports/deprecated.html">Deprecated</a></h3>
        <h3 class="phpdocumentor-sidebar__root-package"><a href="../reports/errors.html">Errors</a></h3>
        <h3 class="phpdocumentor-sidebar__root-package"><a href="../reports/markers.html">Markers</a></h3>
    </section>

    <section class="phpdocumentor-sidebar__category">
        <h2 class="phpdocumentor-sidebar__category-header">Indices</h2>
        <h3 class="phpdocumentor-sidebar__root-package"><a href="../indices/files.html">Files</a></h3>
        <h3 class="phpdocumentor-sidebar__root-package"><a href="../hooks/hooks.html">Hooks Reference</a></h3>
    </section>
</aside>

            <div class="phpdocumentor-column -eight phpdocumentor-content">
                    <ul class="phpdocumentor-breadcrumbs">
    </ul>

    <article class="phpdocumentor-element -file">
        <h2 class="phpdocumentor-content__title">class-woocommerce.php</h2>

                

        
                    <h3 class="phpdocumentor-elements__header" id="source-code">
                Source code
                <a href="#source-code" class="headerlink"><i class="fas fa-link"></i></a>
            </h3>
            <pre id="source-view" tabindex="-1" class="language-php line-numbers linkable-line-numbers"><code>&lt;?php
/**
 * WooCommerce setup
 *
 * @package WooCommerce
 * @since   3.2.0
 */

defined( &#039;ABSPATH&#039; ) || exit;

use Automattic\WooCommerce\Internal\DownloadPermissionsAdjuster;
use Automattic\WooCommerce\Internal\RestockRefundedItemsAdjuster;
use Automattic\WooCommerce\Internal\AssignDefaultCategory;
use Automattic\WooCommerce\Internal\ProductAttributesLookup\DataRegenerator;
use Automattic\WooCommerce\Proxies\LegacyProxy;

/**
 * Main WooCommerce Class.
 *
 * @class WooCommerce
 */
final class WooCommerce {

	/**
	 * WooCommerce version.
	 *
	 * @var string
	 */
	public $version = &#039;5.5.0&#039;;

	/**
	 * WooCommerce Schema version.
	 *
	 * @since 4.3 started with version string 430.
	 *
	 * @var string
	 */
	public $db_version = &#039;430&#039;;

	/**
	 * The single instance of the class.
	 *
	 * @var WooCommerce
	 * @since 2.1
	 */
	protected static $_instance = null;

	/**
	 * Session instance.
	 *
	 * @var WC_Session|WC_Session_Handler
	 */
	public $session = null;

	/**
	 * Query instance.
	 *
	 * @var WC_Query
	 */
	public $query = null;

	/**
	 * Product factory instance.
	 *
	 * @var WC_Product_Factory
	 */
	public $product_factory = null;

	/**
	 * Countries instance.
	 *
	 * @var WC_Countries
	 */
	public $countries = null;

	/**
	 * Integrations instance.
	 *
	 * @var WC_Integrations
	 */
	public $integrations = null;

	/**
	 * Cart instance.
	 *
	 * @var WC_Cart
	 */
	public $cart = null;

	/**
	 * Customer instance.
	 *
	 * @var WC_Customer
	 */
	public $customer = null;

	/**
	 * Order factory instance.
	 *
	 * @var WC_Order_Factory
	 */
	public $order_factory = null;

	/**
	 * Structured data instance.
	 *
	 * @var WC_Structured_Data
	 */
	public $structured_data = null;

	/**
	 * Array of deprecated hook handlers.
	 *
	 * @var array of WC_Deprecated_Hooks
	 */
	public $deprecated_hook_handlers = array();

	/**
	 * Main WooCommerce Instance.
	 *
	 * Ensures only one instance of WooCommerce is loaded or can be loaded.
	 *
	 * @since 2.1
	 * @static
	 * @see WC()
	 * @return WooCommerce - Main instance.
	 */
	public static function instance() {
		if ( is_null( self::$_instance ) ) {
			self::$_instance = new self();
		}
		return self::$_instance;
	}

	/**
	 * Cloning is forbidden.
	 *
	 * @since 2.1
	 */
	public function __clone() {
		wc_doing_it_wrong( __FUNCTION__, __( &#039;Cloning is forbidden.&#039;, &#039;woocommerce&#039; ), &#039;2.1&#039; );
	}

	/**
	 * Unserializing instances of this class is forbidden.
	 *
	 * @since 2.1
	 */
	public function __wakeup() {
		wc_doing_it_wrong( __FUNCTION__, __( &#039;Unserializing instances of this class is forbidden.&#039;, &#039;woocommerce&#039; ), &#039;2.1&#039; );
	}

	/**
	 * Auto-load in-accessible properties on demand.
	 *
	 * @param mixed $key Key name.
	 * @return mixed
	 */
	public function __get( $key ) {
		if ( in_array( $key, array( &#039;payment_gateways&#039;, &#039;shipping&#039;, &#039;mailer&#039;, &#039;checkout&#039; ), true ) ) {
			return $this-&gt;$key();
		}
	}

	/**
	 * WooCommerce Constructor.
	 */
	public function __construct() {
		$this-&gt;define_constants();
		$this-&gt;define_tables();
		$this-&gt;includes();
		$this-&gt;init_hooks();
	}

	/**
	 * When WP has loaded all plugins, trigger the `woocommerce_loaded` hook.
	 *
	 * This ensures `woocommerce_loaded` is called only after all other plugins
	 * are loaded, to avoid issues caused by plugin directory naming changing
	 * the load order. See #21524 for details.
	 *
	 * @since 3.6.0
	 */
	public function on_plugins_loaded() {
		do_action( &#039;woocommerce_loaded&#039; );
	}

	/**
	 * Hook into actions and filters.
	 *
	 * @since 2.3
	 */
	private function init_hooks() {
		register_activation_hook( WC_PLUGIN_FILE, array( &#039;WC_Install&#039;, &#039;install&#039; ) );
		register_shutdown_function( array( $this, &#039;log_errors&#039; ) );

		add_action( &#039;plugins_loaded&#039;, array( $this, &#039;on_plugins_loaded&#039; ), -1 );
		add_action( &#039;admin_notices&#039;, array( $this, &#039;build_dependencies_notice&#039; ) );
		add_action( &#039;after_setup_theme&#039;, array( $this, &#039;setup_environment&#039; ) );
		add_action( &#039;after_setup_theme&#039;, array( $this, &#039;include_template_functions&#039; ), 11 );
		add_action( &#039;init&#039;, array( $this, &#039;init&#039; ), 0 );
		add_action( &#039;init&#039;, array( &#039;WC_Shortcodes&#039;, &#039;init&#039; ) );
		add_action( &#039;init&#039;, array( &#039;WC_Emails&#039;, &#039;init_transactional_emails&#039; ) );
		add_action( &#039;init&#039;, array( $this, &#039;add_image_sizes&#039; ) );
		add_action( &#039;init&#039;, array( $this, &#039;load_rest_api&#039; ) );
		add_action( &#039;switch_blog&#039;, array( $this, &#039;wpdb_table_fix&#039; ), 0 );
		add_action( &#039;activated_plugin&#039;, array( $this, &#039;activated_plugin&#039; ) );
		add_action( &#039;deactivated_plugin&#039;, array( $this, &#039;deactivated_plugin&#039; ) );
		add_action( &#039;woocommerce_installed&#039;, array( $this, &#039;add_woocommerce_inbox_variant&#039; ) );
		add_action( &#039;woocommerce_updated&#039;, array( $this, &#039;add_woocommerce_inbox_variant&#039; ) );

		// These classes set up hooks on instantiation.
		wc_get_container()-&gt;get( DownloadPermissionsAdjuster::class );
		wc_get_container()-&gt;get( AssignDefaultCategory::class );
		wc_get_container()-&gt;get( DataRegenerator::class );
		wc_get_container()-&gt;get( RestockRefundedItemsAdjuster::class );
	}

	/**
	 * Add woocommerce_inbox_variant for the Remote Inbox Notification.
	 *
	 * P2 post can be found at https://wp.me/paJDYF-1uJ.
	 */
	public function add_woocommerce_inbox_variant() {
		$config_name = &#039;woocommerce_inbox_variant_assignment&#039;;
		if ( false === get_option( $config_name, false ) ) {
			update_option( $config_name, wp_rand( 1, 12 ) );
		}
	}
	/**
	 * Ensures fatal errors are logged so they can be picked up in the status report.
	 *
	 * @since 3.2.0
	 */
	public function log_errors() {
		$error = error_get_last();
		if ( $error &amp;&amp; in_array( $error[&#039;type&#039;], array( E_ERROR, E_PARSE, E_COMPILE_ERROR, E_USER_ERROR, E_RECOVERABLE_ERROR ), true ) ) {
			$logger = wc_get_logger();
			$logger-&gt;critical(
				/* translators: 1: error message 2: file name and path 3: line number */
				sprintf( __( &#039;%1$s in %2$s on line %3$s&#039;, &#039;woocommerce&#039; ), $error[&#039;message&#039;], $error[&#039;file&#039;], $error[&#039;line&#039;] ) . PHP_EOL,
				array(
					&#039;source&#039; =&gt; &#039;fatal-errors&#039;,
				)
			);
			do_action( &#039;woocommerce_shutdown_error&#039;, $error );
		}
	}

	/**
	 * Define WC Constants.
	 */
	private function define_constants() {
		$upload_dir = wp_upload_dir( null, false );

		$this-&gt;define( &#039;WC_ABSPATH&#039;, dirname( WC_PLUGIN_FILE ) . &#039;/&#039; );
		$this-&gt;define( &#039;WC_PLUGIN_BASENAME&#039;, plugin_basename( WC_PLUGIN_FILE ) );
		$this-&gt;define( &#039;WC_VERSION&#039;, $this-&gt;version );
		$this-&gt;define( &#039;WOOCOMMERCE_VERSION&#039;, $this-&gt;version );
		$this-&gt;define( &#039;WC_ROUNDING_PRECISION&#039;, 6 );
		$this-&gt;define( &#039;WC_DISCOUNT_ROUNDING_MODE&#039;, 2 );
		$this-&gt;define( &#039;WC_TAX_ROUNDING_MODE&#039;, &#039;yes&#039; === get_option( &#039;woocommerce_prices_include_tax&#039;, &#039;no&#039; ) ? 2 : 1 );
		$this-&gt;define( &#039;WC_DELIMITER&#039;, &#039;|&#039; );
		$this-&gt;define( &#039;WC_LOG_DIR&#039;, $upload_dir[&#039;basedir&#039;] . &#039;/wc-logs/&#039; );
		$this-&gt;define( &#039;WC_SESSION_CACHE_GROUP&#039;, &#039;wc_session_id&#039; );
		$this-&gt;define( &#039;WC_TEMPLATE_DEBUG_MODE&#039;, false );
		$this-&gt;define( &#039;WC_NOTICE_MIN_PHP_VERSION&#039;, &#039;7.2&#039; );
		$this-&gt;define( &#039;WC_NOTICE_MIN_WP_VERSION&#039;, &#039;5.2&#039; );
		$this-&gt;define( &#039;WC_PHP_MIN_REQUIREMENTS_NOTICE&#039;, &#039;wp_php_min_requirements_&#039; . WC_NOTICE_MIN_PHP_VERSION . &#039;_&#039; . WC_NOTICE_MIN_WP_VERSION );
		/** Define if we&#039;re checking against major, minor or no versions in the following places:
		 *   - plugin screen in WP Admin (displaying extra warning when updating to new major versions)
		 *   - System Status Report (&#039;Installed version not tested with active version of WooCommerce&#039; warning)
		 *   - core update screen in WP Admin (displaying extra warning when updating to new major versions)
		 *   - enable/disable automated updates in the plugin screen in WP Admin (if there are any plugins
		 *      that don&#039;t declare compatibility, the auto-update is disabled)
		 *
		 * We dropped SemVer before WC 5.0, so all versions are backwards compatible now, thus no more check needed.
		 * The SSR in the name is preserved for bw compatibility, as this was initially used in System Status Report.
		 */
		$this-&gt;define( &#039;WC_SSR_PLUGIN_UPDATE_RELEASE_VERSION_TYPE&#039;, &#039;none&#039; );

	}

	/**
	 * Register custom tables within $wpdb object.
	 */
	private function define_tables() {
		global $wpdb;

		// List of tables without prefixes.
		$tables = array(
			&#039;payment_tokenmeta&#039;      =&gt; &#039;woocommerce_payment_tokenmeta&#039;,
			&#039;order_itemmeta&#039;         =&gt; &#039;woocommerce_order_itemmeta&#039;,
			&#039;wc_product_meta_lookup&#039; =&gt; &#039;wc_product_meta_lookup&#039;,
			&#039;wc_tax_rate_classes&#039;    =&gt; &#039;wc_tax_rate_classes&#039;,
			&#039;wc_reserved_stock&#039;      =&gt; &#039;wc_reserved_stock&#039;,
		);

		foreach ( $tables as $name =&gt; $table ) {
			$wpdb-&gt;$name    = $wpdb-&gt;prefix . $table;
			$wpdb-&gt;tables[] = $table;
		}
	}

	/**
	 * Define constant if not already set.
	 *
	 * @param string      $name  Constant name.
	 * @param string|bool $value Constant value.
	 */
	private function define( $name, $value ) {
		if ( ! defined( $name ) ) {
			define( $name, $value );
		}
	}

	/**
	 * Returns true if the request is a non-legacy REST API request.
	 *
	 * Legacy REST requests should still run some extra code for backwards compatibility.
	 *
	 * @todo: replace this function once core WP function is available: https://core.trac.wordpress.org/ticket/42061.
	 *
	 * @return bool
	 */
	public function is_rest_api_request() {
		if ( empty( $_SERVER[&#039;REQUEST_URI&#039;] ) ) {
			return false;
		}

		$rest_prefix         = trailingslashit( rest_get_url_prefix() );
		$is_rest_api_request = ( false !== strpos( $_SERVER[&#039;REQUEST_URI&#039;], $rest_prefix ) ); // phpcs:disable WordPress.Security.ValidatedSanitizedInput.MissingUnslash, WordPress.Security.ValidatedSanitizedInput.InputNotSanitized

		return apply_filters( &#039;woocommerce_is_rest_api_request&#039;, $is_rest_api_request );
	}

	/**
	 * Load REST API.
	 */
	public function load_rest_api() {
		\Automattic\WooCommerce\RestApi\Server::instance()-&gt;init();
	}

	/**
	 * What type of request is this?
	 *
	 * @param  string $type admin, ajax, cron or frontend.
	 * @return bool
	 */
	private function is_request( $type ) {
		switch ( $type ) {
			case &#039;admin&#039;:
				return is_admin();
			case &#039;ajax&#039;:
				return defined( &#039;DOING_AJAX&#039; );
			case &#039;cron&#039;:
				return defined( &#039;DOING_CRON&#039; );
			case &#039;frontend&#039;:
				return ( ! is_admin() || defined( &#039;DOING_AJAX&#039; ) ) &amp;&amp; ! defined( &#039;DOING_CRON&#039; ) &amp;&amp; ! $this-&gt;is_rest_api_request();
		}
	}

	/**
	 * Include required core files used in admin and on the frontend.
	 */
	public function includes() {
		/**
		 * Class autoloader.
		 */
		include_once WC_ABSPATH . &#039;includes/class-wc-autoloader.php&#039;;

		/**
		 * Interfaces.
		 */
		include_once WC_ABSPATH . &#039;includes/interfaces/class-wc-abstract-order-data-store-interface.php&#039;;
		include_once WC_ABSPATH . &#039;includes/interfaces/class-wc-coupon-data-store-interface.php&#039;;
		include_once WC_ABSPATH . &#039;includes/interfaces/class-wc-customer-data-store-interface.php&#039;;
		include_once WC_ABSPATH . &#039;includes/interfaces/class-wc-customer-download-data-store-interface.php&#039;;
		include_once WC_ABSPATH . &#039;includes/interfaces/class-wc-customer-download-log-data-store-interface.php&#039;;
		include_once WC_ABSPATH . &#039;includes/interfaces/class-wc-object-data-store-interface.php&#039;;
		include_once WC_ABSPATH . &#039;includes/interfaces/class-wc-order-data-store-interface.php&#039;;
		include_once WC_ABSPATH . &#039;includes/interfaces/class-wc-order-item-data-store-interface.php&#039;;
		include_once WC_ABSPATH . &#039;includes/interfaces/class-wc-order-item-product-data-store-interface.php&#039;;
		include_once WC_ABSPATH . &#039;includes/interfaces/class-wc-order-item-type-data-store-interface.php&#039;;
		include_once WC_ABSPATH . &#039;includes/interfaces/class-wc-order-refund-data-store-interface.php&#039;;
		include_once WC_ABSPATH . &#039;includes/interfaces/class-wc-payment-token-data-store-interface.php&#039;;
		include_once WC_ABSPATH . &#039;includes/interfaces/class-wc-product-data-store-interface.php&#039;;
		include_once WC_ABSPATH . &#039;includes/interfaces/class-wc-product-variable-data-store-interface.php&#039;;
		include_once WC_ABSPATH . &#039;includes/interfaces/class-wc-shipping-zone-data-store-interface.php&#039;;
		include_once WC_ABSPATH . &#039;includes/interfaces/class-wc-logger-interface.php&#039;;
		include_once WC_ABSPATH . &#039;includes/interfaces/class-wc-log-handler-interface.php&#039;;
		include_once WC_ABSPATH . &#039;includes/interfaces/class-wc-webhooks-data-store-interface.php&#039;;
		include_once WC_ABSPATH . &#039;includes/interfaces/class-wc-queue-interface.php&#039;;

		/**
		 * Core traits.
		 */
		include_once WC_ABSPATH . &#039;includes/traits/trait-wc-item-totals.php&#039;;

		/**
		 * Abstract classes.
		 */
		include_once WC_ABSPATH . &#039;includes/abstracts/abstract-wc-data.php&#039;;
		include_once WC_ABSPATH . &#039;includes/abstracts/abstract-wc-object-query.php&#039;;
		include_once WC_ABSPATH . &#039;includes/abstracts/abstract-wc-payment-token.php&#039;;
		include_once WC_ABSPATH . &#039;includes/abstracts/abstract-wc-product.php&#039;;
		include_once WC_ABSPATH . &#039;includes/abstracts/abstract-wc-order.php&#039;;
		include_once WC_ABSPATH . &#039;includes/abstracts/abstract-wc-settings-api.php&#039;;
		include_once WC_ABSPATH . &#039;includes/abstracts/abstract-wc-shipping-method.php&#039;;
		include_once WC_ABSPATH . &#039;includes/abstracts/abstract-wc-payment-gateway.php&#039;;
		include_once WC_ABSPATH . &#039;includes/abstracts/abstract-wc-integration.php&#039;;
		include_once WC_ABSPATH . &#039;includes/abstracts/abstract-wc-log-handler.php&#039;;
		include_once WC_ABSPATH . &#039;includes/abstracts/abstract-wc-deprecated-hooks.php&#039;;
		include_once WC_ABSPATH . &#039;includes/abstracts/abstract-wc-session.php&#039;;
		include_once WC_ABSPATH . &#039;includes/abstracts/abstract-wc-privacy.php&#039;;

		/**
		 * Core classes.
		 */
		include_once WC_ABSPATH . &#039;includes/wc-core-functions.php&#039;;
		include_once WC_ABSPATH . &#039;includes/class-wc-datetime.php&#039;;
		include_once WC_ABSPATH . &#039;includes/class-wc-post-types.php&#039;;
		include_once WC_ABSPATH . &#039;includes/class-wc-install.php&#039;;
		include_once WC_ABSPATH . &#039;includes/class-wc-geolocation.php&#039;;
		include_once WC_ABSPATH . &#039;includes/class-wc-download-handler.php&#039;;
		include_once WC_ABSPATH . &#039;includes/class-wc-comments.php&#039;;
		include_once WC_ABSPATH . &#039;includes/class-wc-post-data.php&#039;;
		include_once WC_ABSPATH . &#039;includes/class-wc-ajax.php&#039;;
		include_once WC_ABSPATH . &#039;includes/class-wc-emails.php&#039;;
		include_once WC_ABSPATH . &#039;includes/class-wc-data-exception.php&#039;;
		include_once WC_ABSPATH . &#039;includes/class-wc-query.php&#039;;
		include_once WC_ABSPATH . &#039;includes/class-wc-meta-data.php&#039;;
		include_once WC_ABSPATH . &#039;includes/class-wc-order-factory.php&#039;;
		include_once WC_ABSPATH . &#039;includes/class-wc-order-query.php&#039;;
		include_once WC_ABSPATH . &#039;includes/class-wc-product-factory.php&#039;;
		include_once WC_ABSPATH . &#039;includes/class-wc-product-query.php&#039;;
		include_once WC_ABSPATH . &#039;includes/class-wc-payment-tokens.php&#039;;
		include_once WC_ABSPATH . &#039;includes/class-wc-shipping-zone.php&#039;;
		include_once WC_ABSPATH . &#039;includes/gateways/class-wc-payment-gateway-cc.php&#039;;
		include_once WC_ABSPATH . &#039;includes/gateways/class-wc-payment-gateway-echeck.php&#039;;
		include_once WC_ABSPATH . &#039;includes/class-wc-countries.php&#039;;
		include_once WC_ABSPATH . &#039;includes/class-wc-integrations.php&#039;;
		include_once WC_ABSPATH . &#039;includes/class-wc-cache-helper.php&#039;;
		include_once WC_ABSPATH . &#039;includes/class-wc-https.php&#039;;
		include_once WC_ABSPATH . &#039;includes/class-wc-deprecated-action-hooks.php&#039;;
		include_once WC_ABSPATH . &#039;includes/class-wc-deprecated-filter-hooks.php&#039;;
		include_once WC_ABSPATH . &#039;includes/class-wc-background-emailer.php&#039;;
		include_once WC_ABSPATH . &#039;includes/class-wc-discounts.php&#039;;
		include_once WC_ABSPATH . &#039;includes/class-wc-cart-totals.php&#039;;
		include_once WC_ABSPATH . &#039;includes/customizer/class-wc-shop-customizer.php&#039;;
		include_once WC_ABSPATH . &#039;includes/class-wc-regenerate-images.php&#039;;
		include_once WC_ABSPATH . &#039;includes/class-wc-privacy.php&#039;;
		include_once WC_ABSPATH . &#039;includes/class-wc-structured-data.php&#039;;
		include_once WC_ABSPATH . &#039;includes/class-wc-shortcodes.php&#039;;
		include_once WC_ABSPATH . &#039;includes/class-wc-logger.php&#039;;
		include_once WC_ABSPATH . &#039;includes/queue/class-wc-action-queue.php&#039;;
		include_once WC_ABSPATH . &#039;includes/queue/class-wc-queue.php&#039;;
		include_once WC_ABSPATH . &#039;includes/admin/marketplace-suggestions/class-wc-marketplace-updater.php&#039;;
		include_once WC_ABSPATH . &#039;includes/blocks/class-wc-blocks-utils.php&#039;;

		/**
		 * Data stores - used to store and retrieve CRUD object data from the database.
		 */
		include_once WC_ABSPATH . &#039;includes/class-wc-data-store.php&#039;;
		include_once WC_ABSPATH . &#039;includes/data-stores/class-wc-data-store-wp.php&#039;;
		include_once WC_ABSPATH . &#039;includes/data-stores/class-wc-coupon-data-store-cpt.php&#039;;
		include_once WC_ABSPATH . &#039;includes/data-stores/class-wc-product-data-store-cpt.php&#039;;
		include_once WC_ABSPATH . &#039;includes/data-stores/class-wc-product-grouped-data-store-cpt.php&#039;;
		include_once WC_ABSPATH . &#039;includes/data-stores/class-wc-product-variable-data-store-cpt.php&#039;;
		include_once WC_ABSPATH . &#039;includes/data-stores/class-wc-product-variation-data-store-cpt.php&#039;;
		include_once WC_ABSPATH . &#039;includes/data-stores/abstract-wc-order-item-type-data-store.php&#039;;
		include_once WC_ABSPATH . &#039;includes/data-stores/class-wc-order-item-data-store.php&#039;;
		include_once WC_ABSPATH . &#039;includes/data-stores/class-wc-order-item-coupon-data-store.php&#039;;
		include_once WC_ABSPATH . &#039;includes/data-stores/class-wc-order-item-fee-data-store.php&#039;;
		include_once WC_ABSPATH . &#039;includes/data-stores/class-wc-order-item-product-data-store.php&#039;;
		include_once WC_ABSPATH . &#039;includes/data-stores/class-wc-order-item-shipping-data-store.php&#039;;
		include_once WC_ABSPATH . &#039;includes/data-stores/class-wc-order-item-tax-data-store.php&#039;;
		include_once WC_ABSPATH . &#039;includes/data-stores/class-wc-payment-token-data-store.php&#039;;
		include_once WC_ABSPATH . &#039;includes/data-stores/class-wc-customer-data-store.php&#039;;
		include_once WC_ABSPATH . &#039;includes/data-stores/class-wc-customer-data-store-session.php&#039;;
		include_once WC_ABSPATH . &#039;includes/data-stores/class-wc-customer-download-data-store.php&#039;;
		include_once WC_ABSPATH . &#039;includes/data-stores/class-wc-customer-download-log-data-store.php&#039;;
		include_once WC_ABSPATH . &#039;includes/data-stores/class-wc-shipping-zone-data-store.php&#039;;
		include_once WC_ABSPATH . &#039;includes/data-stores/abstract-wc-order-data-store-cpt.php&#039;;
		include_once WC_ABSPATH . &#039;includes/data-stores/class-wc-order-data-store-cpt.php&#039;;
		include_once WC_ABSPATH . &#039;includes/data-stores/class-wc-order-refund-data-store-cpt.php&#039;;
		include_once WC_ABSPATH . &#039;includes/data-stores/class-wc-webhook-data-store.php&#039;;

		/**
		 * REST API.
		 */
		include_once WC_ABSPATH . &#039;includes/legacy/class-wc-legacy-api.php&#039;;
		include_once WC_ABSPATH . &#039;includes/class-wc-api.php&#039;;
		include_once WC_ABSPATH . &#039;includes/class-wc-rest-authentication.php&#039;;
		include_once WC_ABSPATH . &#039;includes/class-wc-rest-exception.php&#039;;
		include_once WC_ABSPATH . &#039;includes/class-wc-auth.php&#039;;
		include_once WC_ABSPATH . &#039;includes/class-wc-register-wp-admin-settings.php&#039;;

		/**
		 * WCCOM Site.
		 */
		include_once WC_ABSPATH . &#039;includes/wccom-site/class-wc-wccom-site.php&#039;;

		/**
		 * Libraries and packages.
		 */
		include_once WC_ABSPATH . &#039;packages/action-scheduler/action-scheduler.php&#039;;

		if ( defined( &#039;WP_CLI&#039; ) &amp;&amp; WP_CLI ) {
			include_once WC_ABSPATH . &#039;includes/class-wc-cli.php&#039;;
		}

		if ( $this-&gt;is_request( &#039;admin&#039; ) ) {
			include_once WC_ABSPATH . &#039;includes/admin/class-wc-admin.php&#039;;
		}

		if ( $this-&gt;is_request( &#039;frontend&#039; ) ) {
			$this-&gt;frontend_includes();
		}

		if ( $this-&gt;is_request( &#039;cron&#039; ) &amp;&amp; &#039;yes&#039; === get_option( &#039;woocommerce_allow_tracking&#039;, &#039;no&#039; ) ) {
			include_once WC_ABSPATH . &#039;includes/class-wc-tracker.php&#039;;
		}

		$this-&gt;theme_support_includes();
		$this-&gt;query = new WC_Query();
		$this-&gt;api   = new WC_API();
		$this-&gt;api-&gt;init();
	}

	/**
	 * Include classes for theme support.
	 *
	 * @since 3.3.0
	 */
	private function theme_support_includes() {
		if ( wc_is_wp_default_theme_active() ) {
			switch ( get_template() ) {
				case &#039;twentyten&#039;:
					include_once WC_ABSPATH . &#039;includes/theme-support/class-wc-twenty-ten.php&#039;;
					break;
				case &#039;twentyeleven&#039;:
					include_once WC_ABSPATH . &#039;includes/theme-support/class-wc-twenty-eleven.php&#039;;
					break;
				case &#039;twentytwelve&#039;:
					include_once WC_ABSPATH . &#039;includes/theme-support/class-wc-twenty-twelve.php&#039;;
					break;
				case &#039;twentythirteen&#039;:
					include_once WC_ABSPATH . &#039;includes/theme-support/class-wc-twenty-thirteen.php&#039;;
					break;
				case &#039;twentyfourteen&#039;:
					include_once WC_ABSPATH . &#039;includes/theme-support/class-wc-twenty-fourteen.php&#039;;
					break;
				case &#039;twentyfifteen&#039;:
					include_once WC_ABSPATH . &#039;includes/theme-support/class-wc-twenty-fifteen.php&#039;;
					break;
				case &#039;twentysixteen&#039;:
					include_once WC_ABSPATH . &#039;includes/theme-support/class-wc-twenty-sixteen.php&#039;;
					break;
				case &#039;twentyseventeen&#039;:
					include_once WC_ABSPATH . &#039;includes/theme-support/class-wc-twenty-seventeen.php&#039;;
					break;
				case &#039;twentynineteen&#039;:
					include_once WC_ABSPATH . &#039;includes/theme-support/class-wc-twenty-nineteen.php&#039;;
					break;
				case &#039;twentytwenty&#039;:
					include_once WC_ABSPATH . &#039;includes/theme-support/class-wc-twenty-twenty.php&#039;;
					break;
				case &#039;twentytwentyone&#039;:
					include_once WC_ABSPATH . &#039;includes/theme-support/class-wc-twenty-twenty-one.php&#039;;
					break;
			}
		}
	}

	/**
	 * Include required frontend files.
	 */
	public function frontend_includes() {
		include_once WC_ABSPATH . &#039;includes/wc-cart-functions.php&#039;;
		include_once WC_ABSPATH . &#039;includes/wc-notice-functions.php&#039;;
		include_once WC_ABSPATH . &#039;includes/wc-template-hooks.php&#039;;
		include_once WC_ABSPATH . &#039;includes/class-wc-template-loader.php&#039;;
		include_once WC_ABSPATH . &#039;includes/class-wc-frontend-scripts.php&#039;;
		include_once WC_ABSPATH . &#039;includes/class-wc-form-handler.php&#039;;
		include_once WC_ABSPATH . &#039;includes/class-wc-cart.php&#039;;
		include_once WC_ABSPATH . &#039;includes/class-wc-tax.php&#039;;
		include_once WC_ABSPATH . &#039;includes/class-wc-shipping-zones.php&#039;;
		include_once WC_ABSPATH . &#039;includes/class-wc-customer.php&#039;;
		include_once WC_ABSPATH . &#039;includes/class-wc-embed.php&#039;;
		include_once WC_ABSPATH . &#039;includes/class-wc-session-handler.php&#039;;
	}

	/**
	 * Function used to Init WooCommerce Template Functions - This makes them pluggable by plugins and themes.
	 */
	public function include_template_functions() {
		include_once WC_ABSPATH . &#039;includes/wc-template-functions.php&#039;;
	}

	/**
	 * Init WooCommerce when WordPress Initialises.
	 */
	public function init() {
		// Before init action.
		do_action( &#039;before_woocommerce_init&#039; );

		// Set up localisation.
		$this-&gt;load_plugin_textdomain();

		// Load class instances.
		$this-&gt;product_factory                     = new WC_Product_Factory();
		$this-&gt;order_factory                       = new WC_Order_Factory();
		$this-&gt;countries                           = new WC_Countries();
		$this-&gt;integrations                        = new WC_Integrations();
		$this-&gt;structured_data                     = new WC_Structured_Data();
		$this-&gt;deprecated_hook_handlers[&#039;actions&#039;] = new WC_Deprecated_Action_Hooks();
		$this-&gt;deprecated_hook_handlers[&#039;filters&#039;] = new WC_Deprecated_Filter_Hooks();

		// Classes/actions loaded for the frontend and for ajax requests.
		if ( $this-&gt;is_request( &#039;frontend&#039; ) ) {
			wc_load_cart();
		}

		$this-&gt;load_webhooks();

		// Init action.
		do_action( &#039;woocommerce_init&#039; );
	}

	/**
	 * Load Localisation files.
	 *
	 * Note: the first-loaded translation file overrides any following ones if the same translation is present.
	 *
	 * Locales found in:
	 *      - WP_LANG_DIR/woocommerce/woocommerce-LOCALE.mo
	 *      - WP_LANG_DIR/plugins/woocommerce-LOCALE.mo
	 */
	public function load_plugin_textdomain() {
		$locale = determine_locale();
		$locale = apply_filters( &#039;plugin_locale&#039;, $locale, &#039;woocommerce&#039; );

		unload_textdomain( &#039;woocommerce&#039; );
		load_textdomain( &#039;woocommerce&#039;, WP_LANG_DIR . &#039;/woocommerce/woocommerce-&#039; . $locale . &#039;.mo&#039; );
		load_plugin_textdomain( &#039;woocommerce&#039;, false, plugin_basename( dirname( WC_PLUGIN_FILE ) ) . &#039;/i18n/languages&#039; );
	}

	/**
	 * Ensure theme and server variable compatibility and setup image sizes.
	 */
	public function setup_environment() {
		/**
		 * WC_TEMPLATE_PATH constant.
		 *
		 * @deprecated 2.2 Use WC()-&gt;template_path() instead.
		 */
		$this-&gt;define( &#039;WC_TEMPLATE_PATH&#039;, $this-&gt;template_path() );

		$this-&gt;add_thumbnail_support();
	}

	/**
	 * Ensure post thumbnail support is turned on.
	 */
	private function add_thumbnail_support() {
		if ( ! current_theme_supports( &#039;post-thumbnails&#039; ) ) {
			add_theme_support( &#039;post-thumbnails&#039; );
		}
		add_post_type_support( &#039;product&#039;, &#039;thumbnail&#039; );
	}

	/**
	 * Add WC Image sizes to WP.
	 *
	 * As of 3.3, image sizes can be registered via themes using add_theme_support for woocommerce
	 * and defining an array of args. If these are not defined, we will use defaults. This is
	 * handled in wc_get_image_size function.
	 *
	 * 3.3 sizes:
	 *
	 * woocommerce_thumbnail - Used in product listings. We assume these work for a 3 column grid layout.
	 * woocommerce_single - Used on single product pages for the main image.
	 *
	 * @since 2.3
	 */
	public function add_image_sizes() {
		$thumbnail         = wc_get_image_size( &#039;thumbnail&#039; );
		$single            = wc_get_image_size( &#039;single&#039; );
		$gallery_thumbnail = wc_get_image_size( &#039;gallery_thumbnail&#039; );

		add_image_size( &#039;woocommerce_thumbnail&#039;, $thumbnail[&#039;width&#039;], $thumbnail[&#039;height&#039;], $thumbnail[&#039;crop&#039;] );
		add_image_size( &#039;woocommerce_single&#039;, $single[&#039;width&#039;], $single[&#039;height&#039;], $single[&#039;crop&#039;] );
		add_image_size( &#039;woocommerce_gallery_thumbnail&#039;, $gallery_thumbnail[&#039;width&#039;], $gallery_thumbnail[&#039;height&#039;], $gallery_thumbnail[&#039;crop&#039;] );

		/**
		 * Legacy image sizes.
		 *
		 * @deprecated 3.3.0 These sizes will be removed in 4.6.0.
		 */
		add_image_size( &#039;shop_catalog&#039;, $thumbnail[&#039;width&#039;], $thumbnail[&#039;height&#039;], $thumbnail[&#039;crop&#039;] );
		add_image_size( &#039;shop_single&#039;, $single[&#039;width&#039;], $single[&#039;height&#039;], $single[&#039;crop&#039;] );
		add_image_size( &#039;shop_thumbnail&#039;, $gallery_thumbnail[&#039;width&#039;], $gallery_thumbnail[&#039;height&#039;], $gallery_thumbnail[&#039;crop&#039;] );
	}

	/**
	 * Get the plugin url.
	 *
	 * @return string
	 */
	public function plugin_url() {
		return untrailingslashit( plugins_url( &#039;/&#039;, WC_PLUGIN_FILE ) );
	}

	/**
	 * Get the plugin path.
	 *
	 * @return string
	 */
	public function plugin_path() {
		return untrailingslashit( plugin_dir_path( WC_PLUGIN_FILE ) );
	}

	/**
	 * Get the template path.
	 *
	 * @return string
	 */
	public function template_path() {
		return apply_filters( &#039;woocommerce_template_path&#039;, &#039;woocommerce/&#039; );
	}

	/**
	 * Get Ajax URL.
	 *
	 * @return string
	 */
	public function ajax_url() {
		return admin_url( &#039;admin-ajax.php&#039;, &#039;relative&#039; );
	}

	/**
	 * Return the WC API URL for a given request.
	 *
	 * @param string    $request Requested endpoint.
	 * @param bool|null $ssl     If should use SSL, null if should auto detect. Default: null.
	 * @return string
	 */
	public function api_request_url( $request, $ssl = null ) {
		if ( is_null( $ssl ) ) {
			$scheme = wp_parse_url( home_url(), PHP_URL_SCHEME );
		} elseif ( $ssl ) {
			$scheme = &#039;https&#039;;
		} else {
			$scheme = &#039;http&#039;;
		}

		if ( strstr( get_option( &#039;permalink_structure&#039; ), &#039;/index.php/&#039; ) ) {
			$api_request_url = trailingslashit( home_url( &#039;/index.php/wc-api/&#039; . $request, $scheme ) );
		} elseif ( get_option( &#039;permalink_structure&#039; ) ) {
			$api_request_url = trailingslashit( home_url( &#039;/wc-api/&#039; . $request, $scheme ) );
		} else {
			$api_request_url = add_query_arg( &#039;wc-api&#039;, $request, trailingslashit( home_url( &#039;&#039;, $scheme ) ) );
		}

		return esc_url_raw( apply_filters( &#039;woocommerce_api_request_url&#039;, $api_request_url, $request, $ssl ) );
	}

	/**
	 * Load &amp; enqueue active webhooks.
	 *
	 * @since 2.2
	 */
	private function load_webhooks() {

		if ( ! is_blog_installed() ) {
			return;
		}

		/**
		 * Hook: woocommerce_load_webhooks_limit.
		 *
		 * @since 3.6.0
		 * @param int $limit Used to limit how many webhooks are loaded. Default: no limit.
		 */
		$limit = apply_filters( &#039;woocommerce_load_webhooks_limit&#039;, null );

		wc_load_webhooks( &#039;active&#039;, $limit );
	}

	/**
	 * Initialize the customer and cart objects and setup customer saving on shutdown.
	 *
	 * @since 3.6.4
	 * @return void
	 */
	public function initialize_cart() {
		// Cart needs customer info.
		if ( is_null( $this-&gt;customer ) || ! $this-&gt;customer instanceof WC_Customer ) {
			$this-&gt;customer = new WC_Customer( get_current_user_id(), true );
			// Customer should be saved during shutdown.
			add_action( &#039;shutdown&#039;, array( $this-&gt;customer, &#039;save&#039; ), 10 );
		}
		if ( is_null( $this-&gt;cart ) || ! $this-&gt;cart instanceof WC_Cart ) {
			$this-&gt;cart = new WC_Cart();
		}
	}

	/**
	 * Initialize the session class.
	 *
	 * @since 3.6.4
	 * @return void
	 */
	public function initialize_session() {
		// Session class, handles session data for users - can be overwritten if custom handler is needed.
		$session_class = apply_filters( &#039;woocommerce_session_handler&#039;, &#039;WC_Session_Handler&#039; );
		if ( is_null( $this-&gt;session ) || ! $this-&gt;session instanceof $session_class ) {
			$this-&gt;session = new $session_class();
			$this-&gt;session-&gt;init();
		}
	}

	/**
	 * Set tablenames inside WPDB object.
	 */
	public function wpdb_table_fix() {
		$this-&gt;define_tables();
	}

	/**
	 * Ran when any plugin is activated.
	 *
	 * @since 3.6.0
	 * @param string $filename The filename of the activated plugin.
	 */
	public function activated_plugin( $filename ) {
		include_once dirname( __FILE__ ) . &#039;/admin/helper/class-wc-helper.php&#039;;

		if ( &#039;/woocommerce.php&#039; === substr( $filename, -16 ) ) {
			set_transient( &#039;woocommerce_activated_plugin&#039;, $filename );
		}

		WC_Helper::activated_plugin( $filename );
	}

	/**
	 * Ran when any plugin is deactivated.
	 *
	 * @since 3.6.0
	 * @param string $filename The filename of the deactivated plugin.
	 */
	public function deactivated_plugin( $filename ) {
		include_once dirname( __FILE__ ) . &#039;/admin/helper/class-wc-helper.php&#039;;

		WC_Helper::deactivated_plugin( $filename );
	}

	/**
	 * Get queue instance.
	 *
	 * @return WC_Queue_Interface
	 */
	public function queue() {
		return WC_Queue::instance();
	}

	/**
	 * Get Checkout Class.
	 *
	 * @return WC_Checkout
	 */
	public function checkout() {
		return WC_Checkout::instance();
	}

	/**
	 * Get gateways class.
	 *
	 * @return WC_Payment_Gateways
	 */
	public function payment_gateways() {
		return WC_Payment_Gateways::instance();
	}

	/**
	 * Get shipping class.
	 *
	 * @return WC_Shipping
	 */
	public function shipping() {
		return WC_Shipping::instance();
	}

	/**
	 * Email Class.
	 *
	 * @return WC_Emails
	 */
	public function mailer() {
		return WC_Emails::instance();
	}

	/**
	 * Check if plugin assets are built and minified
	 *
	 * @return bool
	 */
	public function build_dependencies_satisfied() {
		// Check if we have compiled CSS.
		if ( ! file_exists( WC()-&gt;plugin_path() . &#039;/assets/css/admin.css&#039; ) ) {
			return false;
		}

		// Check if we have minified JS.
		if ( ! file_exists( WC()-&gt;plugin_path() . &#039;/assets/js/admin/woocommerce_admin.min.js&#039; ) ) {
			return false;
		}

		return true;
	}

	/**
	 * Output a admin notice when build dependencies not met.
	 *
	 * @return void
	 */
	public function build_dependencies_notice() {
		if ( $this-&gt;build_dependencies_satisfied() ) {
			return;
		}

		$message_one = __( &#039;You have installed a development version of WooCommerce which requires files to be built and minified. From the plugin directory, run &lt;code&gt;grunt assets&lt;/code&gt; to build and minify assets.&#039;, &#039;woocommerce&#039; );
		$message_two = sprintf(
			/* translators: 1: URL of WordPress.org Repository 2: URL of the GitHub Repository release page */
			__( &#039;Or you can download a pre-built version of the plugin from the &lt;a href=&quot;%1$s&quot;&gt;WordPress.org repository&lt;/a&gt; or by visiting &lt;a href=&quot;%2$s&quot;&gt;the releases page in the GitHub repository&lt;/a&gt;.&#039;, &#039;woocommerce&#039; ),
			&#039;https://wordpress.org/plugins/woocommerce/&#039;,
			&#039;https://github.com/woocommerce/woocommerce/releases&#039;
		);
		printf( &#039;&lt;div class=&quot;error&quot;&gt;&lt;p&gt;%s %s&lt;/p&gt;&lt;/div&gt;&#039;, $message_one, $message_two ); // phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped
	}

	/**
	 * Is the WooCommerce Admin actively included in the WooCommerce core?
	 * Based on presence of a basic WC Admin function.
	 *
	 * @return boolean
	 */
	public function is_wc_admin_active() {
		return function_exists( &#039;wc_admin_url&#039; );
	}

	/**
	 * Call a user function. This should be used to execute any non-idempotent function, especially
	 * those in the `includes` directory or provided by WordPress.
	 *
	 * This method can be useful for unit tests, since functions called using this method
	 * can be easily mocked by using WC_Unit_Test_Case::register_legacy_proxy_function_mocks.
	 *
	 * @param string $function_name The function to execute.
	 * @param mixed  ...$parameters The parameters to pass to the function.
	 *
	 * @return mixed The result from the function.
	 *
	 * @since 4.4
	 */
	public function call_function( $function_name, ...$parameters ) {
		return wc_get_container()-&gt;get( LegacyProxy::class )-&gt;call_function( $function_name, ...$parameters );
	}

	/**
	 * Call a static method in a class. This should be used to execute any non-idempotent method in classes
	 * from the `includes` directory.
	 *
	 * This method can be useful for unit tests, since methods called using this method
	 * can be easily mocked by using WC_Unit_Test_Case::register_legacy_proxy_static_mocks.
	 *
	 * @param string $class_name The name of the class containing the method.
	 * @param string $method_name The name of the method.
	 * @param mixed  ...$parameters The parameters to pass to the method.
	 *
	 * @return mixed The result from the method.
	 *
	 * @since 4.4
	 */
	public function call_static( $class_name, $method_name, ...$parameters ) {
		return wc_get_container()-&gt;get( LegacyProxy::class )-&gt;call_static( $class_name, $method_name, ...$parameters );
	}

	/**
	 * Gets an instance of a given legacy class.
	 * This must not be used to get instances of classes in the `src` directory.
	 *
	 * This method can be useful for unit tests, since objects obtained using this method
	 * can be easily mocked by using WC_Unit_Test_Case::register_legacy_proxy_class_mocks.
	 *
	 * @param string $class_name The name of the class to get an instance for.
	 * @param mixed  ...$args Parameters to be passed to the class constructor or to the appropriate internal &#039;get_instance_of_&#039; method.
	 *
	 * @return object The instance of the class.
	 * @throws \Exception The requested class belongs to the `src` directory, or there was an error creating an instance of the class.
	 *
	 * @since 4.4
	 */
	public function get_instance_of( string $class_name, ...$args ) {
		return wc_get_container()-&gt;get( LegacyProxy::class )-&gt;get_instance_of( $class_name, ...$args );
	}
}
</code></pre>
            </article>
            </div>
        </div>
        <a href="#top" class="phpdocumentor-back-to-top"><i class="fas fa-chevron-circle-up"></i></a>

    </main>

    <footer class="phpdocumentor phpdocumentor-footer">
    <div class="phpdocumentor-section">
        <span>WooCommerce Code Reference API documentation generated by <a href="http://www.phpdoc.org/">phpDocumentor</a> on July 12th, 2021 at 10:33 am.</span>
    </div>
</footer>

    <script>
        cssVars({});
    </script>
    <script>
        var searchParams = {
            'searchIndex': '..\/js\/searchIndex.json'
        };
    </script>
    <script src="../js/searchIndex.js?updated=1626085995"></script>
    <script src="../js/search.js?updated=1626085995"></script>
</body>
</html>
